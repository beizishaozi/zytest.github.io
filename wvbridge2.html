<html>
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <title>
        js调用java
    </title>
</head>

<body>
<p>
    <div id="show">log 输出</div>
</p>


<p><input type="button" id="enter3" value="payInterface" onclick="payInterface();"/></p>

</body>
<script>
        function obj2string(o){ 
            var r=[]; 
            if(typeof o=="string"){ 
                return "\""+o.replace(/([\'\"\\])/g,"\\$1").replace(/(\n)/g,"\\n").replace(/(\r)/g,"\\r").replace(/(\t)/g,"\\t")+"\""; 
            } 
            if(typeof o=="object"){ 
                if(!o.sort){ 
                    for(var i in o){ 
                        r.push(i+":"+obj2string(o[i])); 
                    } 
                    if(!!document.all&&!/^\n?function\s*toString\(\)\s*\{\n?\s*\[native code\]\n?\s*\}\n?\s*$/.test(o.toString)){ 
                        r.push("toString:"+o.toString.toString()); 
                    } 
                    r="{"+r.join()+"}"; 
                }else{ 
                    for(var i=0;i<o.length;i++){ 
                        r.push(obj2string(o[i])) 
                    } 
                    r="["+r.join()+"]"; 
                }  
                return r; 
            }  
            return o.toString(); 
        } 

        function setupWebViewJavascriptBridge(callback) {
            if (window._WebViewJavascriptBridge) {
                alert(obj2string(window._WebViewJavascriptBridge))
                //alert("1")
                callback(window._WebViewJavascriptBridge)
            } else {
                document.addEventListener(
                    'WebViewJavascriptBridgeReady'
                    , function() {
                        callback(WebViewJavascriptBridge)
                    },
                    false
                );
            }
            /*
            if (window.WVJBCallbacks) { return window.WVJBCallbacks.push(callback); }
            window.WVJBCallbacks = [callback];
            var WVJBIframe = document.createElement('iframe');
            WVJBIframe.style.display = 'none';
            WVJBIframe.src = 'wvjbscheme://__BRIDGE_LOADED__';
            document.documentElement.appendChild(WVJBIframe);
            setTimeout(function() { document.documentElement.removeChild(WVJBIframe) }, 0)*/
        }

        //在改function 中添加原生调起js方法
        alert("11")
        setupWebViewJavascriptBridge(function(bridge) {

            //注册原生调起方法
            //参数1： buttonjs 注册flag 供原生使用，要和原生统一
            //参数2： data  是原生传给js 的数据
            //参数3： responseCallback 是js 的回调，可以通过该方法给原生传数据
            /*bridge.registerHandler("getUserInfos",function(data,responseCallback){

                document.getElementById("show").innerHTML = "buuton js" + data;
                responseCallback("button js callback");
            });*/


            document.getElementById('enter3').onclick = function (e) {
            var data = "hello"
            //参数1： pay 注册flag 供原生使用，要和原生统一
            //参数2： 是调起原生时向原生传递的参数
            //参数3： 原生调用回调返回的数据
            alert("onclick")
            bridge._handleMessageFromJs("data",null,null,"acquire","getDeviceInfo");
        }
        })

        var WebViewJavascriptBridge = new Object();
        WebViewJavascriptBridge._handleMessageFromJava = function(arg1) {
            //alert(arg1);
            document.getElementById("show").innerHTML = arg1;
        }
</script>

</html>